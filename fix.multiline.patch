--- a/app.py
+++ b/app.py
@@ -1,5 +1,6 @@
 from flask import Flask, render_template, request, redirect, url_for, jsonify
 from flask_sqlalchemy import SQLAlchemy
 import hashlib
+import os
 
 app = Flask(__name__)
 app.config["SQLALCHEMY_DATABASE_URI"] = "sqlite:///todo.db"
@@ -21,9 +22,9 @@
 def add():
     title = request.form.get("title")
     if title:
-        sql = f"INSERT INTO todo (title, complete) VALUES ('{title}', 0)"
-        db.session.execute(sql)
+        new_todo = Todo(title=title, complete=False)
+        db.session.add(new_todo)
         db.session.commit()
     return redirect(url_for("index"))
 
@@ -153,7 +154,7 @@
     todo = Todo(title=title, complete=False)
     db.session.add(todo)
     db.session.commit()
-    sig = hashlib.md5(title.encode()).hexdigest()
+    sig = hashlib.sha256(title.encode()).hexdigest()
     print(f"Storing signature for todo {todo.id}: {sig}")
 
     return jsonify({
@@ -251,4 +252,4 @@
     db.create_all()
 
 if __name__ == "__main__":
-  app.run(debug=True)
+  app.run(debug=os.environ.get('FLASK_DEBUG', '').lower() == 'true')

