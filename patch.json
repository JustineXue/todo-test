{
    "rationale": "The vulnerability exists because user input (title) is directly interpolated into a SQL string using an f-string on line 24, allowing potential SQL injection attacks. The fix replaces the raw SQL execution with SQLAlchemy ORM's safe object creation pattern, which is already used consistently throughout the rest of the application (e.g., lines 153-155 in api_create_todo). This approach automatically handles parameterization and prevents SQL injection while maintaining identical functionality.",
    "patch": "--- a/app.py\n+++ b/app.py\n@@ -21,9 +21,9 @@\n def add():\n     title = request.form.get(\"title\")\n     if title:\n-        sql = f\"INSERT INTO todo (title, complete) VALUES ('{title}', 0)\"\n-        db.session.execute(sql)\n-        db.session.commit()\n+        todo = Todo(title=title, complete=False)\n+        db.session.add(todo)\n+        db.session.commit()\n     return redirect(url_for(\"index\"))\n \n @app.route(\"/complete/<int:todo_id>\")\n"
}