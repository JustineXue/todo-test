{
    "rationale": "The vulnerability exists because user input (title) is directly interpolated into a SQL string using an f-string on line 24, allowing SQL injection attacks. The fix replaces the raw SQL execution with SQLAlchemy's ORM, which uses parameterized queries internally. This approach is already used successfully in other routes (e.g., api_create_todo on line 153), so it maintains consistency with the existing codebase and requires no new dependencies.",
    "patch": "--- a/app.py\n+++ b/app.py\n@@ -21,9 +21,9 @@\n def add():\n     title = request.form.get(\"title\")\n     if title:\n-        sql = f\"INSERT INTO todo (title, complete) VALUES ('{title}', 0)\"\n-        db.session.execute(sql)\n+        todo = Todo(title=title, complete=False)\n+        db.session.add(todo)\n         db.session.commit()\n     return redirect(url_for(\"index\"))\n \n @app.route(\"/complete/<int:todo_id>\")\n"
}