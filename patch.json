{
    "rationale": "Four security vulnerabilities were fixed: (1) SQL injection on lines 24-25 replaced raw SQL execution with SQLAlchemy ORM's add() method, which uses parameterized queries and prevents injection attacks. (2) Debug mode disabled on line 254 by changing debug=True to debug=False to prevent sensitive information leakage in production. (3) Tainted SQL string vulnerability resolved by the same ORM fix as #1. (4) Insecure MD5 hash on line 156 replaced with SHA256, which is cryptographically secure and collision-resistant. All changes preserve existing functionality while eliminating security risks.",
    "patch": "--- a/app.py\n+++ b/app.py\n@@ -20,9 +20,9 @@\n @app.route(\"/add\", methods=[\"POST\"])\n def add():\n     title = request.form.get(\"title\")\n     if title:\n-        sql = f\"INSERT INTO todo (title, complete) VALUES ('{title}', 0)\"\n-        db.session.execute(sql)\n+        todo = Todo(title=title, complete=False)\n+        db.session.add(todo)\n         db.session.commit()\n     return redirect(url_for(\"index\"))\n \n@@ -153,7 +153,7 @@\n     todo = Todo(title=title, complete=False)\n     db.session.add(todo)\n     db.session.commit()\n-    sig = hashlib.md5(title.encode()).hexdigest()\n+    sig = hashlib.sha256(title.encode()).hexdigest()\n     print(f\"Storing signature for todo {todo.id}: {sig}\")\n \n     return jsonify({\n@@ -251,4 +251,4 @@\n     db.create_all()\n \n if __name__ == \"__main__\":\n-    app.run(debug=True)\n+    app.run(debug=False)"
}